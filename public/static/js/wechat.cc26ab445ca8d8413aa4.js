webpackJsonp([29],{"/kga":function(t,e,n){"use strict";var a={mixins:[n("JkZY").a],name:"x-dialog",model:{prop:"show",event:"change"},props:{show:{type:Boolean,default:!1},maskTransition:{type:String,default:"vux-mask"},maskZIndex:[String,Number],dialogTransition:{type:String,default:"vux-dialog"},dialogClass:{type:String,default:"weui-dialog"},hideOnBlur:Boolean,dialogStyle:Object,scroll:{type:Boolean,default:!0,validator:function(t){return!0}}},computed:{maskStyle:function(){if(void 0!==this.maskZIndex)return{zIndex:this.maskZIndex}}},mounted:function(){"undefined"!=typeof window&&window.VUX_CONFIG&&"VIEW_BOX"===window.VUX_CONFIG.$layout&&(this.layout="VIEW_BOX")},watch:{show:function(t){this.$emit("update:show",t),this.$emit(t?"on-show":"on-hide"),t?this.addModalClassName():this.removeModalClassName()}},methods:{shouldPreventScroll:function(){var t=/iPad|iPhone|iPod/i.test(window.navigator.userAgent),e=this.$el.querySelector("input")||this.$el.querySelector("textarea");if(t&&e)return!0},hide:function(){this.hideOnBlur&&(this.$emit("update:show",!1),this.$emit("change",!1),this.$emit("on-click-mask"))}},data:function(){return{layout:""}}},i={render:function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"vux-x-dialog",class:{"vux-x-dialog-absolute":"VIEW_BOX"===this.layout}},[e("transition",{attrs:{name:this.maskTransition}},[e("div",{directives:[{name:"show",rawName:"v-show",value:this.show,expression:"show"}],staticClass:"weui-mask",style:this.maskStyle,on:{click:this.hide}})]),this._v(" "),e("transition",{attrs:{name:this.dialogTransition}},[e("div",{directives:[{name:"show",rawName:"v-show",value:this.show,expression:"show"}],class:this.dialogClass,style:this.dialogStyle},[this._t("default")],2)])],1)},staticRenderFns:[]};var o=n("VU/8")(a,i,!1,function(t){n("6Erz")},null,null);e.a=o.exports},"4S7G":function(t,e,n){"use strict";e.a={setToken:function(t){window.localStorage.setItem("jwt_token",t)},getToken:function(){return window.localStorage.getItem("jwt_token")},removeToken:function(){window.localStorage.removeItem("jwt_token")}}},"62KO":function(t,e,n){"use strict";var a={name:"confirm",components:{XDialog:n("/kga").a},props:{value:{type:Boolean,default:!1},showInput:{type:Boolean,default:!1},placeholder:{type:String,default:""},theme:{type:String,default:"ios"},hideOnBlur:{type:Boolean,default:!1},title:String,confirmText:String,cancelText:String,maskTransition:{type:String,default:"vux-fade"},maskZIndex:[Number,String],dialogTransition:{type:String,default:"vux-dialog"},content:String,closeOnConfirm:{type:Boolean,default:!0},inputAttrs:Object,showContent:{type:Boolean,default:!0},confirmType:{type:String,default:"primary"}},created:function(){this.showValue=this.show,this.value&&(this.showValue=this.value)},watch:{value:function(t){this.showValue=t},showValue:function(t){var e=this;this.$emit("input",t),t&&(this.showInput&&(this.msg="",setTimeout(function(){e.$refs.input&&e.setInputFocus()},300)),this.$emit("on-show"))}},data:function(){return{msg:"",showValue:!1}},methods:{setInputValue:function(t){this.msg=t},setInputFocus:function(){this.$refs.input.focus()},_onConfirm:function(){this.showValue&&(this.closeOnConfirm&&(this.showValue=!1),this.$emit("on-confirm",this.msg))},_onCancel:function(){this.showValue&&(this.showValue=!1,this.$emit("on-cancel"))}}},i={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"vux-confirm"},[n("x-dialog",{attrs:{"dialog-class":"android"===t.theme?"weui-dialog weui-skin_android":"weui-dialog","mask-transition":t.maskTransition,"dialog-transition":"android"===t.theme?"vux-fade":t.dialogTransition,"hide-on-blur":t.hideOnBlur,"mask-z-index":t.maskZIndex},on:{"on-hide":function(e){t.$emit("on-hide")}},model:{value:t.showValue,callback:function(e){t.showValue=e},expression:"showValue"}},[t.title?n("div",{staticClass:"weui-dialog__hd",class:{"with-no-content":!t.showContent}},[n("strong",{staticClass:"weui-dialog__title"},[t._v(t._s(t.title))])]):t._e(),t._v(" "),t.showContent?[t.showInput?n("div",{staticClass:"vux-prompt",on:{touchstart:function(e){e.preventDefault(),t.setInputFocus(e)}}},[n("input",t._b({directives:[{name:"model",rawName:"v-model",value:t.msg,expression:"msg"}],ref:"input",staticClass:"vux-prompt-msgbox",attrs:{placeholder:t.placeholder},domProps:{value:t.msg},on:{input:function(e){e.target.composing||(t.msg=e.target.value)}}},"input",t.inputAttrs,!1))]):n("div",{staticClass:"weui-dialog__bd"},[t._t("default",[n("div",{domProps:{innerHTML:t._s(t.content)}})])],2)]:t._e(),t._v(" "),n("div",{staticClass:"weui-dialog__ft"},[n("a",{staticClass:"weui-dialog__btn weui-dialog__btn_default",attrs:{href:"javascript:;"},on:{click:t._onCancel}},[t._v(t._s(t.cancelText||"取消"))]),t._v(" "),n("a",{staticClass:"weui-dialog__btn",class:"weui-dialog__btn_"+t.confirmType,attrs:{href:"javascript:;"},on:{click:t._onConfirm}},[t._v(t._s(t.confirmText||"确定"))])])],2)],1)},staticRenderFns:[]};var o=n("VU/8")(a,i,!1,function(t){n("tV8G")},null,null);e.a=o.exports},"6Erz":function(t,e){},Dsfc:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var a=n("//Fk"),i=n.n(a),o=n("7+uW"),s=n("/ocq"),u={render:function(){var t=this.$createElement,e=this._self._c||t;return e("div",{attrs:{id:"app"}},[e("router-view")],1)},staticRenderFns:[]},r=n("VU/8")({name:"app"},u,!1,null,null,null).exports,l=n("mtWM"),c=n.n(l),d=n("dgq6"),h=n("4S7G"),m=function(){return n.e(23).then(n.bind(null,"eiJC"))},p=[{path:"/wechat_auth",name:"wechat_auth",component:function(){return n.e(26).then(n.bind(null,"eYe4"))},meta:{wechatAuth:!0}},{path:"/register",name:"register",component:function(){return n.e(14).then(n.bind(null,"SeBb"))}},{path:"/login/:username",name:"login",component:function(){return n.e(27).then(n.bind(null,"6cqi"))}},{path:"/user_index",name:"user_index",component:function(){return n.e(20).then(n.bind(null,"55G3"))},meta:{wechatAuth:!0}},{path:"/user_info",name:"user_info",component:function(){return n.e(8).then(n.bind(null,"AUEY"))},meta:{wechatAuth:!0}},{path:"/edit_info",name:"edit_info",component:function(){return n.e(13).then(n.bind(null,"p3Ey"))},meta:{wechatAuth:!0}},{path:"/health/:user_id",name:"health",component:m,meta:{wechatAuth:!0}},{path:"/health",name:"health",component:m,meta:{wechatAuth:!0}},{path:"/health_detail/:health_id",name:"health_detail",component:function(){return n.e(22).then(n.bind(null,"cUsz"))},meta:{wechatAuth:!0}},{path:"/concern_index",name:"concern_index",component:function(){return n.e(15).then(n.bind(null,"Yh5v"))},meta:{wechatAuth:!0}},{path:"/enterprise_index",name:"enterprise_index",component:function(){return n.e(25).then(n.bind(null,"pbvE"))},meta:{wechatAuth:!0}},{path:"/admin",name:"admin",component:function(){return n.e(21).then(n.bind(null,"zqdL"))},meta:{wechatAuth:!0}},{path:"/enterprise_info",name:"enterprise_info",component:function(){return n.e(11).then(n.bind(null,"yfhI"))},meta:{wechatAuth:!0}},{path:"/enterprise_edit_info",name:"enterprise_edit_info",component:function(){return n.e(17).then(n.bind(null,"7K4r"))},meta:{wechatAuth:!0}},{path:"/worker_index",name:"worker_index",component:function(){return n.e(10).then(n.bind(null,"IRnr"))},meta:{wechatAuth:!0}}],f=new s.a({routes:p});f.beforeEach(function(t,e,n){if(t.path.match("/username/")){var a=t.path.split("/")[2];d.a.dispatch("loginRequest",{username:a,password:a}).then(function(t){axios.post("api/user/info").then(function(t){t.data.data.mobile?n("/user_index"):n("/register")})}).catch(function(t){})}if(t.meta.wechatAuth){if(d.a.state.authenticated||h.a.getToken())return n();axios.post("api/wechat/getOauthURL",{path:t.path}).then(function(e){window.localStorage.setItem("user_to_url",t.path),window.location.href=e.data.data})}return n()});var w=f,g=n("odsO"),_=n("7t+N"),v=n.n(_),x=n("hU7x"),k=n.n(x),T=n("NXWw"),y=n("Peep");window.axios=c.a,window.$=v.a,window.jsonp=k.a,o.default.use(s.a),o.default.use(g.a),o.default.use(T.a),o.default.use(y.a),c.a.interceptors.request.use(function(t){return h.a.getToken()&&(t.headers.Authorization="Bearer "+h.a.getToken()),t},function(t){return i.a.reject(t)}),c.a.interceptors.response.use(function(t){return t},function(t){return 401==t.response.status||419==t.response.status?(d.a.dispatch("refreshToken"),i.a.reject(t)):i.a.reject(t)}),new o.default({el:"#app",router:w,store:d.a,template:"<App/>",components:{App:r}})},"GVd+":function(t,e){},dgq6:function(t,e,n){"use strict";var a=n("7+uW"),i=n("NYxO"),o={state:{username:null,authenticated:!1},mutations:{set_user_auth:function(t,e){t.username=e.user.data.username,t.authenticated=!0,console.log("set_user_auth")},del_user_auth:function(t){t.username=null,t.authenticated=!1}},actions:{setAuthUser:function(t){var e=t.commit;t.dispatch;axios.post("/api/user/info").then(function(t){return console.log("info"),e({type:"set_user_auth",user:t.data}),t})},delAuthUser:function(t){return(0,t.commit)({type:"del_user_auth"})},refreshToken:function(t){t.commit;var e=t.dispatch;return axios.post("api/auth/refreshToken").then(function(t){e("loginSuccess",t.data)}).catch(function(t){e("logoutRequest")})}}},s=n("//Fk"),u=n.n(s),r=n("4S7G"),l={actions:{loginRequest:function(t,e){var n=t.dispatch;return axios.post("/api/auth/login",e).then(function(t){n("loginSuccess",t.data)}).catch(function(t){return u.a.reject(t)})},loginSuccess:function(t,e){var n=t.dispatch;r.a.setToken(e.token),n("setAuthUser")},logoutRequest:function(t){var e=t.dispatch;return axios.post("/api/user/logout").then(function(t){return r.a.removeToken(),e("delAuthUser"),t})}}};a.default.use(i.a);e.a=new i.a.Store({modules:{AuthUser:o,Login:l}})},mzja:function(t,e,n){"use strict";var a={name:"alert",components:{XDialog:n("/kga").a},created:function(){void 0!==this.value&&(this.showValue=this.value)},props:{value:Boolean,title:String,content:String,buttonText:String,hideOnBlur:{type:Boolean,default:!1},maskTransition:{type:String,default:"vux-mask"},dialogTransition:{type:String,default:"vux-dialog"},maskZIndex:[Number,String]},data:function(){return{showValue:!1}},methods:{_onHide:function(){this.showValue=!1}},watch:{value:function(t){this.showValue=t},showValue:function(t){this.$emit("input",t)}}},i={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"vux-alert"},[n("x-dialog",{attrs:{"mask-transition":t.maskTransition,"dialog-transition":t.dialogTransition,"hide-on-blur":t.hideOnBlur,"mask-z-index":t.maskZIndex},on:{"on-hide":function(e){t.$emit("on-hide")},"on-show":function(e){t.$emit("on-show")}},model:{value:t.showValue,callback:function(e){t.showValue=e},expression:"showValue"}},[n("div",{staticClass:"weui-dialog__hd"},[n("strong",{staticClass:"weui-dialog__title"},[t._v(t._s(t.title))])]),t._v(" "),n("div",{staticClass:"weui-dialog__bd"},[t._t("default",[n("div",{domProps:{innerHTML:t._s(t.content)}})])],2),t._v(" "),n("div",{staticClass:"weui-dialog__ft"},[n("a",{staticClass:"weui-dialog__btn weui-dialog__btn_primary",attrs:{href:"javascript:;"},on:{click:t._onHide}},[t._v(t._s(t.buttonText||"确定"))])])])],1)},staticRenderFns:[]};var o=n("VU/8")(a,i,!1,function(t){n("GVd+")},null,null);e.a=o.exports},odsO:function(t,e,n){"use strict";var a=n("Wxq9");n.n(a);e.a={install:function(t,e){t.prototype.message=function(t){return void 0===t.data.status?this.$message(t.data.msg):1===t.data.status&&void 0===t.data.data?this.$message.success(t.data.msg):this.$message.error(t.data.msg)},t.prototype.formatSelectOptions=function(t){var e=[];for(var n in t)e.push({value:n,label:t[n]});return e},t.prototype.formatSelectOptionsForVux=function(t){var e=[];for(var n in t)e.push({value:n,name:t[n]});return e},t.prototype.formatToTextForAddress=function(t){var e={};return t.forEach(function(t,n){0==n&&(e.province=a.CodeToText[t]),1==n&&(e.city=a.CodeToText[t]),2==n&&(e.district=a.CodeToText[t])}),e},t.prototype.formatToCodeForAddress=function(t,e,n){var i=[];return i[0]=a.TextToCode[t].code,i[1]=a.TextToCode[t][e].code,i[2]=a.TextToCode[t][e][n].code,i},t.prototype.getPermission=function(t){axios.post("api/frontend_permission",t).then(function(t){return t.data.data})}}}},tV8G:function(t,e){}},["Dsfc"]);
//# sourceMappingURL=wechat.cc26ab445ca8d8413aa4.js.map