{"version":3,"sources":["webpack:///./src/components/helpers/jwt.js","webpack:///./src/pages/wechat/Wechat.vue?8e32","webpack:///./src/pages/wechat/Wechat.vue?220c","webpack:///./src/pages/wechat/Wechat.vue","webpack:///./src/pages/wechat/router/index.js","webpack:///./src/pages/wechat/wechat.js","webpack:///./src/components/store/modules/auth-user.js","webpack:///./src/components/store/modules/login.js","webpack:///./src/components/store/index.js","webpack:///./src/components/helpers/common.js"],"names":["__webpack_exports__","setToken","token","window","localStorage","setItem","getToken","getItem","removeToken","removeItem","wechat_Wechat","render","_h","this","$createElement","_c","_self","attrs","id","staticRenderFns","pages_wechat_Wechat","__webpack_require__","normalizeComponent","name","ssrContext","routes","path","component","e","then","bind","meta","wechatAuth","router","vue_router_esm","beforeEach","to","from","next","match","username","split","store","dispatch","password","response","console","log","catch","error","_this","$message","data","message","state","authenticated","axios","post","location","href","wechat_router","axios_default","a","$","jquery_default","jsonp","jsonp_default","vue_esm","use","common","interceptors","request","config","jwt","headers","promise_default","reject","status","el","template","components","App","auth_user","mutations","set_user_auth","payload","user","del_user_auth","actions","setAuthUser","_ref","commit","type","delAuthUser","_ref2","refreshToken","_ref3","login","loginRequest","formData","loginSuccess","tokenResponse","logoutRequest","vuex_esm","Store","modules","AuthUser","Login","install","Vue","options","prototype","undefined","msg","success","formatSelectOptions","array","value","push","label","formatSelectOptionsForVux","formatToTextForAddress","address","forEach","index","province","__WEBPACK_IMPORTED_MODULE_0_element_china_area_data__","city","district","formatToCodeForAddress","arr","code","getPermission","permissions"],"mappings":"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","file":"static/js/wechat.1fadfbdf44d34454635b.js","sourcesContent":["export default {\n    setToken(token) {\n        window.localStorage.setItem('jwt_token', token);\n    },\n    getToken() {\n        return window.localStorage.getItem('jwt_token');\n    },\n    removeToken() {\n        window.localStorage.removeItem('jwt_token');\n    }\n}\n\n\n// WEBPACK FOOTER //\n// ./src/components/helpers/jwt.js","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{attrs:{\"id\":\"app\"}},[_c('router-view')],1)}\nvar staticRenderFns = []\nvar esExports = { render: render, staticRenderFns: staticRenderFns }\nexport default esExports\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/vue-loader/lib/template-compiler?{\"id\":\"data-v-9dd0b522\",\"hasScoped\":false,\"transformToRequire\":{\"video\":[\"src\",\"poster\"],\"source\":\"src\",\"img\":\"src\",\"image\":\"xlink:href\"},\"buble\":{\"transforms\":{}}}!./node_modules/vux-loader/src/before-template-compiler-loader.js!./node_modules/vux-loader/src/template-loader.js!./node_modules/vue-loader/lib/selector.js?type=template&index=0!./src/pages/wechat/Wechat.vue\n// module id = null\n// module chunks = ","function injectStyle (ssrContext) {\n  require(\"!!../../../node_modules/extract-text-webpack-plugin/dist/loader.js?{\\\"omit\\\":1,\\\"remove\\\":true}!vue-style-loader!css-loader?{\\\"sourceMap\\\":true}!../../../node_modules/vue-loader/lib/style-compiler/index?{\\\"vue\\\":true,\\\"id\\\":\\\"data-v-9dd0b522\\\",\\\"scoped\\\":false,\\\"hasInlineConfig\\\":false}!../../../node_modules/vux-loader/src/style-loader.js!../../../node_modules/vue-loader/lib/selector?type=styles&index=0!./Wechat.vue\")\n}\nvar normalizeComponent = require(\"!../../../node_modules/vue-loader/lib/component-normalizer\")\n/* script */\nexport * from \"!!babel-loader!../../../node_modules/vux-loader/src/script-loader.js!../../../node_modules/vue-loader/lib/selector?type=script&index=0!./Wechat.vue\"\nimport __vue_script__ from \"!!babel-loader!../../../node_modules/vux-loader/src/script-loader.js!../../../node_modules/vue-loader/lib/selector?type=script&index=0!./Wechat.vue\"\n/* template */\nimport __vue_template__ from \"!!../../../node_modules/vue-loader/lib/template-compiler/index?{\\\"id\\\":\\\"data-v-9dd0b522\\\",\\\"hasScoped\\\":false,\\\"transformToRequire\\\":{\\\"video\\\":[\\\"src\\\",\\\"poster\\\"],\\\"source\\\":\\\"src\\\",\\\"img\\\":\\\"src\\\",\\\"image\\\":\\\"xlink:href\\\"},\\\"buble\\\":{\\\"transforms\\\":{}}}!../../../node_modules/vux-loader/src/before-template-compiler-loader.js!../../../node_modules/vux-loader/src/template-loader.js!../../../node_modules/vue-loader/lib/selector?type=template&index=0!./Wechat.vue\"\n/* template functional */\nvar __vue_template_functional__ = false\n/* styles */\nvar __vue_styles__ = injectStyle\n/* scopeId */\nvar __vue_scopeId__ = null\n/* moduleIdentifier (server only) */\nvar __vue_module_identifier__ = null\nvar Component = normalizeComponent(\n  __vue_script__,\n  __vue_template__,\n  __vue_template_functional__,\n  __vue_styles__,\n  __vue_scopeId__,\n  __vue_module_identifier__\n)\n\nexport default Component.exports\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/pages/wechat/Wechat.vue\n// module id = null\n// module chunks = ","//\n//\n//\n//\n//\n//\n\nexport default {\n  name: 'app'\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/pages/wechat/Wechat.vue","import VueRouter from 'vue-router'\nimport Store from '@/components/store/index'\nimport jwtToken from '@/components/helpers/jwt'\n\nconst wechat_auth = () => import('@/components/wechat/auth/wechat_auth.vue');\nconst register = () => import('@/components/wechat/auth/register.vue');\nconst login = () => import('@/components/wechat/auth/login.vue');\n\nconst enterprise_register = () => import('@/components/wechat/enterprise/register.vue')\nconst enterprise_info = () => import('@/components/wechat/enterprise/info.vue')\n\nconst worker_list = () => import('@/components/wechat/worker/list.vue')\n\n\nlet routes = [\n    {path: '/wechat_auth', name: 'wechat_auth', component: wechat_auth},\n    {path: '/register', name: 'register', component: register},\n    {path: '/enterprise_register', name: 'enterprise_register', component: enterprise_register},\n    {path: '/enterprise_info', name: 'enterprise_info', component: enterprise_info},\n    {path: '/worker_list', name: 'worker_list', component: worker_list, meta: {wechatAuth: true}},\n    {path: '/login/:username', name: 'login', component: login},\n];\n\nconst router = new VueRouter({\n    routes,\n    // mode: 'history'\n});\n\nrouter.beforeEach((to, from, next) => {\n    //登录用户\n    if (to.path.match('/username/')) {\n        let arr = to.path.split('/');\n        let username = arr[2];\n        Store.dispatch('loginRequest', {username: username, password: username}).then(response => {\n            console.log(window.localStorage.getItem('user_to_url'));\n            // this.$router.push({name:'index'});\n        }).catch(error => {\n            this.$message.error(error.response.data.message);\n        });\n    }\n\n\n    if (to.meta.wechatAuth) {\n        //验证是否登录\n        // if (Store.state.authenticated || jwtToken.getToken()) {\n        if (Store.state.authenticated) {\n            return next();\n        } else {\n            axios.post('api/wechat/getOauthURL', {path:to.path}).then(response => {\n                window.localStorage.setItem('user_to_url', to.path);\n                //跳转微信授权页面\n                window.location.href = response.data.data;\n            });\n        }\n    }\n\n    return next();\n});\n\nexport default router\n\n\n\n\n// WEBPACK FOOTER //\n// ./src/pages/wechat/router/index.js","import Vue from 'vue'\nimport VueRouter from 'vue-router'\nimport App from './Wechat.vue'\nimport axios from 'axios'\nimport router from './router/index.js'\nimport 'element-ui/lib/theme-chalk/index.css'\nimport store from '@/components/store/index'\nimport jwtToken from '@/components/helpers/jwt'\nimport helpers from '@/components/helpers/common'\nimport jquery from 'jquery'\nimport jsonp from 'jsonp'\n\nwindow.axios = axios;\nwindow.$ = jquery;\nwindow.jsonp = jsonp;\n\nVue.use(VueRouter);\nVue.use(helpers);\n\n/*\n 将token值加入请求中\n */\naxios.interceptors.request.use(function (config) {\n    if (jwtToken.getToken()) {\n        config.headers['Authorization'] = 'Bearer ' + jwtToken.getToken();\n    }\n    return config;\n}, function (error) {\n    return Promise.reject(error);\n});\n\n\naxios.interceptors.response.use(function(response) {\n    //对响应数据做些事\n    return response;\n},function (error) {\n    //请求错误时做些事\n    if (error.response.status == 401 || error.response.status == 419) {\n        store.dispatch('refreshToken');\n        return Promise.reject(error);\n    } else {\n        return Promise.reject(error);\n    }\n});\n\n\nnew Vue({\n    el: '#app',\n    router,\n    store,\n    template: '<App/>',\n    components: { App }\n})\n\n\n\n// WEBPACK FOOTER //\n// ./src/pages/wechat/wechat.js","export default {\n    state: {\n        username: null,\n        authenticated: false, //登录状态\n    },\n    mutations: {\n        set_user_auth(state, payload) {\n            state.username = payload.user.username;\n            state.authenticated = true;\n        },\n        del_user_auth(state) {\n            state.username = null;\n            state.authenticated = false;\n        }\n    },\n    actions: {\n        setAuthUser({commit, dispatch}) {\n            return axios.post('/api/user/user').then(response => {\n                commit({\n                    type: 'set_user_auth',\n                    user: response.data\n                });\n            });\n        },\n        delAuthUser({commit}) {\n            return commit({\n                type: 'del_user_auth',\n            })\n        },\n        refreshToken({commit, dispatch}) {\n            return axios.post('api/auth/refreshToken').then(response => {\n                dispatch('loginSuccess', response.data);\n            }).catch(error => {\n                dispatch('logoutRequest');\n            });\n        }\n    }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/components/store/modules/auth-user.js","import jwtToken from '@/components/helpers/jwt'\n\nexport default {\n    actions: {\n        loginRequest({dispatch}, formData) {\n            return axios.post('/api/auth/login', formData).then(response => {\n                dispatch('loginSuccess', response.data);\n            }).catch(error => {\n                //登录失败\n                return Promise.reject(error);\n            });\n        },\n        loginSuccess({dispatch}, tokenResponse) {\n            jwtToken.setToken(tokenResponse.token);\n            dispatch('setAuthUser');\n        },\n        logoutRequest({dispatch}) {\n            return axios.post('/api/user/logout').then(response => {\n                jwtToken.removeToken();\n                dispatch('delAuthUser');\n                return response;\n            });\n        }\n    }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/components/store/modules/login.js","import Vue from 'vue'\nimport Vuex from 'vuex'\n\nimport AuthUser from './modules/auth-user'\nimport Login from './modules/login'\n\nVue.use(Vuex);\n\nexport default new Vuex.Store({\n    modules: {\n        AuthUser,\n        Login\n    }\n})\n\n\n\n\n// WEBPACK FOOTER //\n// ./src/components/store/index.js","import { CodeToText, TextToCode } from 'element-china-area-data'\n\nexport default {\n    install(Vue,options)\n    {\n        Vue.prototype.message = function (response) {\n            if (response.data.status === undefined) {\n                return this.$message(response.data.msg);\n            }\n\n            if (response.data.status === 1 && response.data.data === undefined) {\n                return this.$message.success(response.data.msg);\n            } else {\n                return this.$message.error(response.data.msg);\n            }\n        };\n        /*\n        将回返的json数据格式化为element-select-options所需格式\n         */\n        Vue.prototype.formatSelectOptions = function(data) {\n            let array = [];\n            for(let value in data) {\n                array.push({value: value, label: data[value]});\n            }\n            return array;\n        }\n        /*\n         将回返的json数据格式化为vux-select-options所需格式\n         */\n        Vue.prototype.formatSelectOptionsForVux = function(data) {\n            let array = [];\n            for(let value in data) {\n                array.push({value: value, name: data[value]});\n            }\n            return array;\n        }\n        /*\n        格式化地址选择器数据\n        return {province: xxx, city: xxx, district: xxx}\n         */\n        Vue.prototype.formatToTextForAddress = function(address) {\n            let data = {};\n            address.forEach((value, index) => {\n                if (index == 0) {\n                    data.province = CodeToText[value]\n                }\n                if (index == 1) {\n                    data.city = CodeToText[value]\n                }\n                if (index == 2) {\n                    data.district = CodeToText[value]\n                }\n            })\n            return data;\n        }\n        /*\n        格式化地址选择器，将地址名称转换为code\n        return [xxx,xxx,xxx]\n         */\n        Vue.prototype.formatToCodeForAddress = function(province, city, district) {\n            let arr = [];\n            arr[0] = TextToCode[province].code;\n            arr[1] = TextToCode[province][city].code;\n            arr[2] = TextToCode[province][city][district].code;\n            return arr;\n        }\n        Vue.prototype.getPermission = function(permissions) {\n            axios.post('api/frontend_permission', permissions).then(response => {\n                return response.data.data\n            })\n        }\n    },\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/components/helpers/common.js"],"sourceRoot":""}